# Redirect homepage to PHP version
DirectoryIndex index.php index.html

# Enable PHP processing
AddType application/x-httpd-php .php

# Start URL Rewriting
RewriteEngine On

# Redirect index.html to index.php
RewriteCond %{THE_REQUEST} /index\.html[\s?] [NC]
RewriteRule ^index\.html$ /index.php [R=301,L]

# Redirect .php extension to clean URL (except for admin and setup files)
RewriteCond %{THE_REQUEST} \s/+(.+)\.php[\s?] [NC]
RewriteCond %1 !^(admin|setup|test_|create-|fix-|update-|add-|optimize-)
RewriteRule ^ /%1? [R=301,L]

# Handle clean URLs for departments (existing rule)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^departments/([^/]+)/?$ departments/$1.php [L]

# Handle clean URLs for services
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^services/([^/]+)/?$ services/$1.php [L]

# General rule: Add .php extension to clean URLs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !.*\.(css|js|png|jpg|jpeg|gif|ico|svg|webp|pdf|txt|xml)$ [NC]
RewriteRule ^([^/]+)/?$ $1.php [L]
