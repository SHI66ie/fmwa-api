# Set PHP as the default homepage (use new index.php as primary)
DirectoryIndex index.php index-main.php index.html

# Enable PHP processing
AddType application/x-httpd-php .php

# Start URL Rewriting
RewriteEngine On

# Force HTTPS for admin and API endpoints
RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_URI} ^/(admin|api) [NC]
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirect HTML files to PHP equivalents
RewriteCond %{THE_REQUEST} /index\.html[\s?] [NC]
RewriteRule ^index\.html$ /index.php [R=301,L]

RewriteCond %{THE_REQUEST} /about\.html[\s?] [NC]
RewriteRule ^about\.html$ /about.php [R=301,L]

RewriteCond %{THE_REQUEST} /mandate\.html[\s?] [NC]
RewriteRule ^mandate\.html$ /mandate.php [R=301,L]

RewriteCond %{THE_REQUEST} /organogram\.html[\s?] [NC]
RewriteRule ^organogram\.html$ /organogram.php [R=301,L]

RewriteCond %{THE_REQUEST} /admin\.html[\s?] [NC]
RewriteRule ^admin\.html$ /admin.php [R=301,L]

# Redirect .php extension to clean URL (except for admin, api, setup, and index files)
RewriteCond %{THE_REQUEST} \s/+(.+)\.php[\s?] [NC]
RewriteCond %1 !^(admin|api|setup|test_|create-|fix-|update-|add-|optimize-|index)
RewriteRule ^ /%1 [R=301,L]

# Handle clean URLs for departments (existing rule)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^departments/([^/]+)/?$ departments/$1.php [L]

# Handle clean URLs for services
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^services/([^/]+)/?$ services/$1.php [L]

# General rule: Add .php extension to clean URLs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !.*\.(css|js|png|jpg|jpeg|gif|ico|svg|webp|pdf|txt|xml)$ [NC]
RewriteRule ^([^/]+)/?$ $1.php [L]
